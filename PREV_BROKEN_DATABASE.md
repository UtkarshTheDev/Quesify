**PREV BROKEN Supabase Schema for Recreation:**
These were Fucked UP Because i made some breaking changes due to which this whole database can't work with my current code the main issues were due to UID and Text mismatch and foreigh policies so take those serousily. Verify with CODE and then only continue to create.
## TABLES(ONLY FOR REFRENCE):
| create_statement                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| CREATE TABLE notifications (id uuid NOT NULL DEFAULT gen_random_uuid(), recipient_id uuid NOT NULL, sender_id uuid, type text NOT NULL, target_id text, metadata jsonb DEFAULT '{}'::jsonb, is_read bool DEFAULT false, created_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                           |
| CREATE TABLE questions (id text NOT NULL DEFAULT (gen_random_uuid())::text, owner_id uuid NOT NULL, question_text text NOT NULL, options jsonb DEFAULT '[]'::jsonb, type text DEFAULT 'MCQ'::text, has_diagram bool DEFAULT false, image_url text, subject text, chapter text, topics jsonb DEFAULT '[]'::jsonb, difficulty text DEFAULT 'medium'::text, importance int4 DEFAULT 3, hint text, embedding vector, popularity int4 DEFAULT 1, created_at timestamptz DEFAULT now(), updated_at timestamptz DEFAULT now()); |
| CREATE TABLE revise_later (id text NOT NULL DEFAULT (gen_random_uuid())::text, user_id uuid NOT NULL, question_id text, added_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                                                                                                                             |
| CREATE TABLE solution_likes (id text NOT NULL DEFAULT (gen_random_uuid())::text, user_id uuid NOT NULL, solution_id text, created_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                                                                                                                         |
| CREATE TABLE solutions (id text NOT NULL DEFAULT (gen_random_uuid())::text, question_id text, contributor_id uuid NOT NULL, solution_text text NOT NULL, numerical_answer text, approach_description text, likes int4 DEFAULT 0, is_ai_best bool DEFAULT false, created_at timestamptz DEFAULT now(), updated_at timestamptz NOT NULL DEFAULT (now() AT TIME ZONE 'utc'::text), correct_option int4, avg_solve_time int4 DEFAULT 0);                                                                                     |
| CREATE TABLE syllabus (id text NOT NULL DEFAULT (gen_random_uuid())::text, class text, subject text NOT NULL, chapter text NOT NULL, topics jsonb DEFAULT '[]'::jsonb, priority int4 DEFAULT 3, is_verified bool DEFAULT true, created_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                    |
| CREATE TABLE user_activities (id text NOT NULL DEFAULT gen_random_uuid(), user_id uuid NOT NULL, activity_type text NOT NULL, target_id text, target_type text, metadata jsonb DEFAULT '{}'::jsonb, created_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                                               |
| CREATE TABLE user_follows (id uuid NOT NULL DEFAULT gen_random_uuid(), follower_id uuid NOT NULL, following_id uuid NOT NULL, created_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                                                                                                                     |
| CREATE TABLE user_profiles (id text NOT NULL DEFAULT (gen_random_uuid())::text, user_id uuid NOT NULL, display_name text, avatar_url text, streak_count int4 DEFAULT 0, last_streak_date date, total_solved int4 DEFAULT 0, total_uploaded int4 DEFAULT 0, solutions_helped_count int4 DEFAULT 0, created_at timestamptz DEFAULT now(), updated_at timestamptz DEFAULT now(), username text, subjects _text);                                                                                                            |
| CREATE TABLE user_question_stats (id text NOT NULL DEFAULT (gen_random_uuid())::text, user_id uuid NOT NULL, question_id text, solved bool DEFAULT false, failed bool DEFAULT false, struggled bool DEFAULT false, attempts int4 DEFAULT 0, time_spent int4 DEFAULT 0, user_difficulty int4, last_practiced_at timestamptz, next_review_at timestamptz, in_revise_later bool DEFAULT false, created_at timestamptz DEFAULT now(), updated_at timestamptz DEFAULT now());                                                 |
| CREATE TABLE user_questions (id text NOT NULL DEFAULT (gen_random_uuid())::text, user_id uuid NOT NULL, question_id text, is_owner bool DEFAULT false, is_contributor bool DEFAULT false, added_at timestamptz DEFAULT now());                                                                                                                                                                                                                                                                                           |

## RLS POLICIES(EVEN MORE FUCKED UP):  
NEED GOOD ACCURACY

| header                             | policyname                                      | cmd    | type        | roles    | using_condition                       | with_check_condition          |
| ---------------------------------- | ----------------------------------------------- | ------ | ----------- | -------- | ------------------------------------- | ----------------------------- |
| --- TABLE: notifications ---       | Users can see their own notifications           | SELECT | RESTRICTIVE | {public} | (auth.uid() = recipient_id)           | null                          |
| --- TABLE: notifications ---       | Users can update their own notifications        | UPDATE | RESTRICTIVE | {public} | (auth.uid() = recipient_id)           | null                          |
| --- TABLE: questions ---           | Anyone can view questions                       | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: questions ---           | Questions are viewable by everyone              | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: revise_later ---        | Users can manage their revise later list        | ALL    | RESTRICTIVE | {public} | (auth.uid() = user_id)                | null                          |
| --- TABLE: solution_likes ---      | Users can manage their own likes                | ALL    | RESTRICTIVE | {public} | (auth.uid() = user_id)                | null                          |
| --- TABLE: solution_likes ---      | Users can view all likes                        | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: solutions ---           | Everyone can view solutions                     | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: solutions ---           | Users can delete their own solutions            | DELETE | RESTRICTIVE | {public} | (auth.uid() = contributor_id)         | null                          |
| --- TABLE: solutions ---           | Users can insert solutions                      | INSERT | RESTRICTIVE | {public} | null                                  | (auth.uid() = contributor_id) |
| --- TABLE: solutions ---           | Users can insert their own solutions            | INSERT | RESTRICTIVE | {public} | null                                  | (auth.uid() = contributor_id) |
| --- TABLE: solutions ---           | Users can update their own solutions            | UPDATE | RESTRICTIVE | {public} | (auth.uid() = contributor_id)         | null                          |
| --- TABLE: syllabus ---            | Authenticated users can view syllabus           | SELECT | RESTRICTIVE | {public} | (auth.role() = 'authenticated'::text) | null                          |
| --- TABLE: user_activities ---     | Public user_activities are viewable by everyone | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: user_follows ---        | Everyone can see follows                        | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: user_follows ---        | Users can manage their own follows              | ALL    | RESTRICTIVE | {public} | (auth.uid() = follower_id)            | null                          |
| --- TABLE: user_profiles ---       | Public profiles are viewable by everyone        | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: user_profiles ---       | Users can insert their own profile              | INSERT | RESTRICTIVE | {public} | null                                  | (auth.uid() = user_id)        |
| --- TABLE: user_profiles ---       | Users can update their own profile              | UPDATE | RESTRICTIVE | {public} | (auth.uid() = user_id)                | null                          |
| --- TABLE: user_profiles ---       | Users can view all profiles                     | SELECT | RESTRICTIVE | {public} | true                                  | null                          |
| --- TABLE: user_question_stats --- | Users can manage their own stats                | ALL    | RESTRICTIVE | {public} | (auth.uid() = user_id)                | null                          |
| --- TABLE: user_questions ---      | Users can delete their own questions            | DELETE | RESTRICTIVE | {public} | (auth.uid() = user_id)                | null                          |
| --- TABLE: user_questions ---      | Users can insert their own questions            | INSERT | RESTRICTIVE | {public} | null                                  | (auth.uid() = user_id)        |
| --- TABLE: user_questions ---      | Users can view their own questions              | SELECT | RESTRICTIVE | {public} | (auth.uid() = user_id)                | null                          |

## RELATIONSHIPS(NEED HIGH ACCURACY MOST INNACURATE IN THE CORRUPTED DATABASE):

| table_name          | column_name | foreign_table_name | foreign_column_name |
| ------------------- | ----------- | ------------------ | ------------------- |
| revise_later        | question_id | questions          | id                  |
| solution_likes      | solution_id | solutions          | id                  |
| user_questions      | question_id | questions          | id                  |
| user_question_stats | question_id | questions          | id                  |
| solutions           | question_id | questions          | id                  |
 

Many RELATIONS AND POLICIES WERE MISSED YOU MIGHT NEED TO CREATE THEM.
